<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack(4.0) | ğŸ˜ˆSingee</title>
    <meta name="description" content="this is singee blog ">
    
    
    <link rel="preload" href="/assets/css/0.styles.b1fe51a6.css" as="style"><link rel="preload" href="/assets/js/app.c7624f26.js" as="script"><link rel="preload" href="/assets/js/2.04cf5e0d.js" as="script"><link rel="preload" href="/assets/js/23.bc303b71.js" as="script"><link rel="prefetch" href="/assets/js/10.d5f1c1ec.js"><link rel="prefetch" href="/assets/js/11.1d509d1f.js"><link rel="prefetch" href="/assets/js/12.72ae5236.js"><link rel="prefetch" href="/assets/js/13.13838250.js"><link rel="prefetch" href="/assets/js/14.10f33b47.js"><link rel="prefetch" href="/assets/js/15.ce547b37.js"><link rel="prefetch" href="/assets/js/16.1692188e.js"><link rel="prefetch" href="/assets/js/17.06ee366a.js"><link rel="prefetch" href="/assets/js/18.00311757.js"><link rel="prefetch" href="/assets/js/19.a4d6a3c8.js"><link rel="prefetch" href="/assets/js/20.71ca09e7.js"><link rel="prefetch" href="/assets/js/21.a898dac2.js"><link rel="prefetch" href="/assets/js/22.a8bbb495.js"><link rel="prefetch" href="/assets/js/24.0192cd3f.js"><link rel="prefetch" href="/assets/js/25.1b343f01.js"><link rel="prefetch" href="/assets/js/26.3fd09c06.js"><link rel="prefetch" href="/assets/js/27.2cdcf487.js"><link rel="prefetch" href="/assets/js/28.64cbf829.js"><link rel="prefetch" href="/assets/js/29.7e75ffef.js"><link rel="prefetch" href="/assets/js/3.fea3fce9.js"><link rel="prefetch" href="/assets/js/4.6576419b.js"><link rel="prefetch" href="/assets/js/5.706d86fc.js"><link rel="prefetch" href="/assets/js/6.94b2acc6.js"><link rel="prefetch" href="/assets/js/7.d7b9eeed.js"><link rel="prefetch" href="/assets/js/8.24d4bb66.js"><link rel="prefetch" href="/assets/js/9.1e274f4c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b1fe51a6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">ğŸ˜ˆSingee</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/pages/article/" class="nav-link">ğŸ˜„æ–‡ç« </a></div><div class="nav-item"><a href="/pages/source/" class="nav-link">ğŸ˜œæºç è§£æ</a></div><div class="nav-item"><a href="/pages/base/" class="nav-link">ğŸ¤¨åŸºç¡€</a></div><div class="nav-item"><a href="/pages/dp/" class="nav-link">âŒ›è®¾è®¡æ¨¡å¼</a></div><div class="nav-item"><a href="/pages/middle/" class="nav-link router-link-active">ğŸ˜µæŠ€æœ¯æ ˆ</a></div><div class="nav-item"><a href="/pages/build/" class="nav-link">ğŸ¤—å·¥ç¨‹</a></div> <a href="https://github.com/xiangxinji/myblog.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    source code
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/pages/article/" class="nav-link">ğŸ˜„æ–‡ç« </a></div><div class="nav-item"><a href="/pages/source/" class="nav-link">ğŸ˜œæºç è§£æ</a></div><div class="nav-item"><a href="/pages/base/" class="nav-link">ğŸ¤¨åŸºç¡€</a></div><div class="nav-item"><a href="/pages/dp/" class="nav-link">âŒ›è®¾è®¡æ¨¡å¼</a></div><div class="nav-item"><a href="/pages/middle/" class="nav-link router-link-active">ğŸ˜µæŠ€æœ¯æ ˆ</a></div><div class="nav-item"><a href="/pages/build/" class="nav-link">ğŸ¤—å·¥ç¨‹</a></div> <a href="https://github.com/xiangxinji/myblog.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    source code
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/" class="sidebar-link">ğŸ˜ˆé¦–é¡µ</a></li><li><a href="/pages/base/" class="sidebar-link">ğŸ¤¨åŸºç¡€ä¸œä¸œ</a></li><li><a href="/pages/middle/" class="sidebar-link">ğŸ“æŠ€æœ¯æ ˆ</a></li><li><a href="/pages/source/" class="sidebar-link">ğŸ§ªæºä»£ç åˆ†æ</a></li><li><a href="/pages/article/webpack/" class="sidebar-link">ğŸ§«éšä¾¿å†™å†™çš„æ–‡ç« </a></li><li><a href="/pages/dp/" class="sidebar-link">âŒ›è®¾è®¡æ¨¡å¼</a></li><li><a href="/pages/build/" class="sidebar-link">ğŸ½ï¸å·¥ç¨‹åŒ–</a></li><li><a href="/pages/years/2019.html" class="sidebar-link">ğŸ˜³å¹´ç»ˆæ€»ç»“</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack-4-0"><a href="#webpack-4-0" class="header-anchor">#</a> Webpack(4.0)</h1> <img src="/images/webpack.jpg" alt="Vue"> <p><a href="https://www.webpackjs.com/" target="_blank" rel="noopener noreferrer">webpackä¸­æ–‡æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="code-splitting-ä»£ç æ‹†åˆ†"><a href="#code-splitting-ä»£ç æ‹†åˆ†" class="header-anchor">#</a> Code Splitting  (ä»£ç æ‹†åˆ†)</h3> <p>Code Splitting ä¸ webpack æ— å…³   , å®ç°ä»£ç æ‹†åˆ†æœ‰å¾ˆå¤šç§å½¢å¼</p> <ol><li>æ‰‹åŠ¨åŠ è½½ ç¬¬ä¸‰æ–¹ä¾èµ–çš„å…¥å£æ–‡ä»¶,è¿›è¡Œæ‰“åŒ…</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>entry<span class="token punctuation">:</span><span class="token punctuation">{</span>
  lodash <span class="token punctuation">:</span> <span class="token string">'../src/lodash.js'</span> <span class="token punctuation">,</span>  <span class="token comment">// è¿™é‡Œå¼•å…¥äº†lodash å¹¶èµ‹å€¼ç»™ windowå¯¹è±¡,  é‚£ä¹ˆwebpack ä¼šå…ˆæ‰“åŒ…								// å‡ºè¿™ä¸ªå…¥å£æ–‡ä»¶ , ç„¶åå†å»æ‰“åŒ…index.js , è‡³æ­¤å°±å®Œæˆäº†ç¬¬ä¸€ç§åŒº							  // åˆ†æ‰“åŒ…</span>
  main <span class="token punctuation">:</span> <span class="token string">'../src/index.js'</span> <span class="token comment">// ä¸šåŠ¡é€»è¾‘çš„å…¥å£æ–‡ä»¶ </span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="2"><li><p>åŒæ­¥åŠ è½½</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code> <span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'lodash'</span> <span class="token punctuation">;</span> <span class="token comment">// 1. åŒæ­¥åŠ è½½ç¬¬ä¸‰æ–¹æ¨¡å— </span>
 <span class="token comment">// _.xx()   </span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ç„¶ååœ¨webpacké…ç½®</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization <span class="token punctuation">:</span> <span class="token punctuation">{</span>
    splitChunks <span class="token punctuation">:</span> <span class="token punctuation">{</span>
      chunks <span class="token punctuation">:</span> <span class="token string">'all'</span> <span class="token punctuation">,</span>   <span class="token comment">// è®©åŒæ­¥æ¨¡å—å’Œå¼‚æ­¥æ¨¡å—éƒ½è¿›è¡Œä»£ç åˆ†ç¦» </span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ol> <h3 id="optimization-splitchunks-é…ç½®"><a href="#optimization-splitchunks-é…ç½®" class="header-anchor">#</a> optimization.splitChunks  é…ç½®</h3> <div class="language-javasciprt line-numbers-mode"><pre class="language-text"><code>module.exports = {
  optimization : {
    splitChunks : {
      chunks : 'async' ,   // å¼‚æ­¥æ¨¡å—è¿›è¡Œä»£ç åˆ†ç¦»
      // é»˜è®¤å€¼async,all:å¼‚æ­¥|åŒæ­¥æ¨¡å—éƒ½è¿›è¡Œä»£ç åˆ†ç¦»,initial åŒæ­¥æ¨¡å—
      minSize : 30000 ,  // æ¨¡å—å¿…é¡»å¤§äº30000å­—èŠ‚æ‰ä¼šè¿›è¡Œä»£ç åˆ†ç¦»
      maxSize : 0  ,	// ç”Ÿæˆä»£ç å—çš„æœ€å¤§å¤§å°,å¦‚æœæ­¤æ¨¡å—å¤§äºè¿™ä¸ªmaxSize é‚£ä¹ˆä»–å¯èƒ½ä¼šè¿›è¡ŒäºŒæ¬¡æ‹†åˆ† 
      minChunks : 1 , // æ‰“åŒ…ä¹‹åçš„Chunkå¼•ç”¨æ­¤æ¨¡å—æ—¶ Chunkå¼•ç”¨æ­¤æ¨¡å—æ•° &gt;=minChunks æ‰ä¼šå¯¹æ­¤æ¨¡å—è¿›è¡Œä»£ç åˆ†å‰² 
      maxAsyncRequests : 5 , // æŒ‰éœ€åŠ è½½æ—¶å¹¶è¡Œè¯·æ±‚çš„æœ€å¤§æ•°é‡ã€‚
      maxInitialRequests:3 , // å…¥å£æ–‡ä»¶çš„æ¨¡å—æœ€å¤§æ‹†åˆ†æ•°  
      automaticNameDelimiter : '~' , //æ‹†åˆ†æ–‡ä»¶åçš„é»˜è®¤è¿æ¥ç¬¦
      name : true , // åˆ†å‰²å—çš„åç§°ã€‚æä¾›trueå°†æ ¹æ®å—å’Œç¼“å­˜ç»„é”®è‡ªåŠ¨ç”Ÿæˆåç§°ã€‚
      cacheGroups: { // ç¼“å­˜ç»„
       	 vendors : {	// vendorç»„
           	 test: /[\\/]node_modules[\\/]/, // åŒ¹é…å¤„äºnode_modulesä¸­çš„æ¨¡å—
          	 priority: -10	// ä¼˜å…ˆçº§   æ•°å€¼è¶Šå¤§è¶Šé«˜
          	 filename : 'vendor.js'
       	 },
       	 default : {	// é»˜è®¤ç»„ 
       	 	priority : -20 , // ä¼˜å…ˆçº§ 
       	 	reuseExistingChunk : true ,   //  å¦‚æœå½“å‰å—åŒ…å«å·²ç»ä»ä¸»åŒ…ä¸­åˆ†ç¦»å‡ºæ¥çš„æ¨¡å—ï¼Œé‚£ä¹ˆå®ƒå°†è¢«é‡ç”¨ï¼Œè€Œä¸æ˜¯ç”Ÿæˆä¸€ä¸ªæ–°çš„æ¨¡å—ã€‚è¿™å¯èƒ½ä¼šå½±å“å—çš„ç»“æœæ–‡ä»¶åã€‚
       	 	filename : 'default.js'
       	 }	
      }
    }
  } 
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="æ‡’åŠ è½½"><a href="#æ‡’åŠ è½½" class="header-anchor">#</a> æ‡’åŠ è½½</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>å½“webpack é‡åˆ°å¼‚æ­¥åŠ è½½æ¨¡å—æ—¶<span class="token punctuation">,</span>webpackä¼šè¿›è¡Œæ‡’åŠ è½½æ¥æå‡æ€§èƒ½<span class="token punctuation">,</span>ä»€ä¹ˆæ—¶å€™åŠ è½½å…³æœºé”®ç‚¹åœ¨äºä»€ä¹ˆæ—¶å€™å¼•å…¥æ­¤æ¨¡å—
vue ä¸­çš„router  å°±æ˜¯é€šè¿‡å¼‚æ­¥åŠ è½½æ¨¡å—æ¥è®©webpackè¿›è¡Œæ‡’åŠ è½½åŠŸèƒ½



<span class="token comment">// chunk : å½“webapck æ‰“åŒ…å‡ºæ¥ä¹‹å ,æ¯æœ‰ä¸€ä¸ªæ–‡ä»¶å°±ç®—ä¸€ä¸ªchunk </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="åˆ†æå·¥å…·"><a href="#åˆ†æå·¥å…·" class="header-anchor">#</a> åˆ†æå·¥å…·</h3> <p>webpack å®˜æ–¹æä¾›äº†éå¸¸å¤šçš„åˆ†æå·¥å…·ï¼Œæ¥åˆ†ææ‰“åŒ…çš„è¿‡ç¨‹å’Œç»“æœ</p> <p>é¦–å…ˆå¾—å¾—åˆ°ä¸€ä¸ªåˆ†æç»“æœæ–‡ä»¶  ã€‚ ä¸€èˆ¬å«åš state.json</p> <p>webpack --profile --json &gt; stats.json</p> <p>å®˜æ–¹æ¨èåˆ†æå·¥å…·ã€ç½‘ç«™</p> <p>https://webpack.js.org/guides/code-splitting/#bundle-analysis</p> <h3 id="prefetching-preloading-modules-ç©ºé—²åŠ è½½-é¢„åŠ è½½-æ¨¡å—"><a href="#prefetching-preloading-modules-ç©ºé—²åŠ è½½-é¢„åŠ è½½-æ¨¡å—" class="header-anchor">#</a> Prefetching/Preloading modules (ç©ºé—²åŠ è½½/é¢„åŠ è½½) æ¨¡å—</h3> <p>webpacké…ç½®æ–‡ä»¶ä¸­</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>optimization<span class="token punctuation">:</span><span class="token punctuation">{</span>
  splitChunks <span class="token punctuation">:</span> <span class="token punctuation">{</span>
    chunks <span class="token punctuation">:</span> <span class="token string">'async'</span>  <span class="token comment">// async ä¸ºé»˜è®¤å€¼ </span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>webpack æ¯”è¾ƒæ¨èçš„æ–¹å¼æ˜¯ å¼‚æ­¥åŠ è½½ ï¼Œ å› ä¸ºåªéœ€è¦åŠ è½½å¯ä½¿ç”¨çš„æ¨¡å—</p> <p>(ç©ºé—²åŠ è½½/é¢„åŠ è½½) æ¨¡å—  è¿™ä¸ªçš„ç”¨å¤„åœ¨äº ï¼Œ å½“ä¸€ä¸ªå¼‚æ­¥æ¨¡å—æ›´æ¢ä»–çš„åŠ è½½æ–¹å¼æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç©ºé—²åŠ è½½æ­¤å¼‚æ­¥æ¨¡å—ï¼Œè¿˜æ˜¯é¢„åŠ è½½å¼‚æ­¥æ¨¡å—</p> <p>åœ¨webpackä¸­å¯ä»¥ä½¿ç”¨é­”æ³•æ³¨é‡Šæ¥å®Œæˆç©ºé—²åŠ è½½/é¢„åŠ è½½ å¼‚æ­¥æ¨¡å—</p> <p>ä¾‹:</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// æ­¤å¼‚æ­¥æ¨¡å—ä¼šè¿›è¡Œç©ºé—²åŠ è½½ </span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> handleClick<span class="token punctuation">:</span> fun <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPrefetch: true */</span><span class="token string">'./click.js'</span><span class="token punctuation">)</span>

<span class="token comment">// æ­¤å¼‚æ­¥æ¨¡å—ä¼šè¿›è¡Œé¢„å…ˆåŠ è½½ </span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> handleClick<span class="token punctuation">:</span> fun <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPreload: true */</span><span class="token string">'./click.js'</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>å…·ä½“æ–‡æ¡£ ï¼š https://webpack.js.org/guides/code-splitting/#bundle-analysis</p> <p>å¯ä»¥æŸ¥çœ‹chromeå¼€å‘è€…å·¥å…·ä¸­çš„ coverage æ¥æŸ¥çœ‹ä»£ç çš„åˆ©ç”¨ç‡ ï¼Œ  é€šå¸¸æ¥è¯´ï¼Œ ä»£ç åˆ©ç”¨ç‡è¶Šé«˜ï¼Œç½‘é¡µæ€§èƒ½è¶Šå¥½</p> <h3 id="ç¼“å­˜"><a href="#ç¼“å­˜" class="header-anchor">#</a> ç¼“å­˜</h3> <p>å¯¹äºwebpackæ¥è¯´,å¯ä»¥ä½¿ç”¨ [contenthash] æ¥è¿›è¡Œç¼“å­˜ç®¡ç† , å¦‚æœä»£ç æ²¡æœ‰è¿›è¡Œæ”¹å˜çš„è¯,hashä¸ä¼šå˜åŒ–</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>output<span class="token punctuation">:</span><span class="token punctuation">{</span>
  filename <span class="token punctuation">:</span> <span class="token string">'main[contenthash].js'</span><span class="token punctuation">,</span>
  chunkFilename <span class="token punctuation">:</span> <span class="token string">'[name][contenthash].js'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>åœ¨è€ç‰ˆæœ¬çš„webpackä¸­ å…¥å£chunk å¯èƒ½æ¯æ¬¡å¯¹åº”çš„contenthash å¯èƒ½ä¸ä¸€æ ·,å› ä¸ºwebpacké»˜è®¤å°†è¿è¡Œæ—¶çš„ä»£ç æ”¾å…¥å…¥å£chunkä¸­,è¿™äº›è¿è¡Œæ—¶çš„ä»£ç å¯èƒ½æ¯æ¬¡è¿è¡Œéƒ½ä¸ä¸€æ · , æ‰€ä»¥æ‰å¯¼è‡´å…¥å£chunk æ¯æ¬¡å¯¹åº”çš„contenthashä¸ä¸€æ ·è§£å†³è¿™ä¸ªé—®é¢˜:</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>optimization <span class="token punctuation">:</span> <span class="token punctuation">{</span>
  runtimeChunk <span class="token punctuation">:</span> <span class="token punctuation">{</span>
    name <span class="token punctuation">:</span> <span class="token string">'runtime'</span> <span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="shimming"><a href="#shimming" class="header-anchor">#</a> Shimming</h3> <p>ç”¨æ¥å¤„ç†å…¼å®¹é—®é¢˜ . .</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// å½“ä½ ä½¿ç”¨ _ å¯¹è±¡æ—¶ , webpack ä¼šå»ä½¿ç”¨ loadsh ä¸­çš„æ¨¡å—å¯¹è±¡  </span>
<span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ProvidePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
       _<span class="token punctuation">:</span> <span class="token string">'lodash'</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="hmr"><a href="#hmr" class="header-anchor">#</a> HMR</h2> <p>HMR (hot module replacement ) çƒ­æ¨¡å—æ›¿æ¢</p> <p>webpack æœ‰ä¸¤ç§æ–¹å¼æ¥å¼€å¯å¼€å‘æœåŠ¡å™¨</p> <ol><li>WDS</li> <li>WDM</li></ol> <p>WDS : é€šè¿‡webpack-dev-server è¿™ä¸ªæ’ä»¶æ¥è¿è¡Œå¼€å‘æœåŠ¡å™¨,æ­¤æ—¶åªè¦ä»£ç æœ‰æ”¹åŠ¨,å‰ç«¯çš„htmlé¡µé¢å°±ä¼šè‡ªåŠ¨åˆ·æ–°</p> <p>WDM : é€šè¿‡è‡ªå·±ç»™nodejsæœåŠ¡å™¨åŠ ä¸Šwebpack-dev-middleware çš„ä¸­é—´ä»¶æ¥è¿›è¡Œæ–‡ä»¶ç›‘å¬,å¹¶åˆ·æ–°</p> <p>WDM ç›¸å¯¹äº WDS æ¥è¯´çš„è¯,WDMçš„è‡ªå®šä¹‰æ€§æ›´é«˜,å› ä¸ºæˆ‘ä»¬å¯ä»¥åœ¨è‡ªå·±çš„nodejsæœåŠ¡å™¨é‡Œåšå‡ºå…¶ä»–æ›´å¤šçš„äº‹æƒ…</p> <p>WDMåŸç† : WDM å°†webpackè¾“å‡ºçš„æ–‡ä»¶ä»¥jsonæ ¼å¼ä¼ è¾“ç»™æœåŠ¡å™¨,æ¥å®Œæˆæ–‡ä»¶ç›‘å¬</p> <h2 id="æ–‡ä»¶æŒ‡çº¹"><a href="#æ–‡ä»¶æŒ‡çº¹" class="header-anchor">#</a> æ–‡ä»¶æŒ‡çº¹</h2> <p>æ–‡ä»¶æŒ‡çº¹ä¸€èˆ¬ç”¨äºç‰ˆæœ¬ç®¡ç†</p> <ol><li>hash : é¡¹ç›®ç›¸å…³,åªè¦é¡¹ç›®æ–‡ä»¶æœ‰ä¿®æ”¹,hashå€¼å°±ä¼šæ”¹å˜</li> <li>chunkhash : å’Œwebpackæ‰“åŒ…çš„chunkæœ‰å…³,ä¸åŒçš„entry ä¼šç”Ÿæˆä¸åŒçš„chunkå€¼</li> <li>contenthash : æ ¹æ®æ–‡ä»¶å†…å®¹å®šä¹‰hash</li></ol> <h2 id="æ–‡ä»¶å‹ç¼©"><a href="#æ–‡ä»¶å‹ç¼©" class="header-anchor">#</a> æ–‡ä»¶å‹ç¼©</h2> <p>webpack4 è‡ªå¸¦jså‹ç¼©,ä»–æ˜¯é€šè¿‡  uglifyjs-webpack-plugin  è¿™ä¸€ä¸ªæ’ä»¶æ¥è¿›è¡Œjså‹ç¼©çš„,é»˜è®¤æ˜¯ä¸²è¡Œå‹ç¼©</p> <p>csså‹ç¼©å‘¢,éœ€è¦åˆ©ç”¨ optimize-css-assets-webpack-plugin  æ’ä»¶å’Œå¦å¤–ä¸€ä¸ªä¾èµ– cssnano æ¥è¿›è¡Œcss å‹ç¼©</p> <p>html å‹ç¼©å°±æ˜¯ html-webpack-plugin æ¥è¿›è¡Œhtmlå‹ç¼©</p> <h2 id="css3-è‡ªåŠ¨è¡¥é½å‰ç¼€"><a href="#css3-è‡ªåŠ¨è¡¥é½å‰ç¼€" class="header-anchor">#</a> css3 è‡ªåŠ¨è¡¥é½å‰ç¼€</h2> <p>ä¾èµ–: post-cssloader + autoprefixer æ’ä»¶</p> <p>é‡Œé¢é…ç½®çš„browsers å¯ä»¥è®¾ç½®è¦å…¼å®¹çš„æµè§ˆå™¨èŒƒå›´</p> <h2 id="è‡ªåŠ¨remè½¬æ¢-ç§»åŠ¨ç«¯"><a href="#è‡ªåŠ¨remè½¬æ¢-ç§»åŠ¨ç«¯" class="header-anchor">#</a> è‡ªåŠ¨REMè½¬æ¢(ç§»åŠ¨ç«¯)</h2> <p>ä¾èµ–: px2remloader + lib-flexible</p> <h2 id="é™æ€èµ„æºå†…è”"><a href="#é™æ€èµ„æºå†…è”" class="header-anchor">#</a> é™æ€èµ„æºå†…è”</h2> <p>å¯ä»¥ä½¿ç”¨raw-loader æ¥å†…è”html å’Œ js</p> <p>csså†…è” : ä½¿ç”¨html-inline-css-webpack-plugin</p> <h2 id="æ‰“åŒ…å¤šé¡µé¢"><a href="#æ‰“åŒ…å¤šé¡µé¢" class="header-anchor">#</a> æ‰“åŒ…å¤šé¡µé¢</h2> <p>å¥½å¤„æ˜¯: è§£è€¦åˆ,åˆ©äºseo</p> <p>åˆ©ç”¨ glob åº“æ¥è¯»å–æ–‡ä»¶å¹¶åŠ¨æ€ç”Ÿæˆ webpack.config çš„entry å…¥å£ å’Œ html-webpack-plugin æ¥è¿›è¡Œå¤šé¡µé¢æ‰“åŒ…</p> <h2 id="source-map"><a href="#source-map" class="header-anchor">#</a> source-map</h2> <p>æºä»£ç æ˜ å°„: å¼€å‘ç¯å¢ƒä¸€èˆ¬å¼€å¯,ç”Ÿäº§ç¯å¢ƒç›´æ¥å…³é—­</p> <h2 id="æå–å…¬å…±èµ„æº"><a href="#æå–å…¬å…±èµ„æº" class="header-anchor">#</a> æå–å…¬å…±èµ„æº</h2> <p>ä¸€äº›åŸºç¡€åº“: å¯ä»¥åˆ©ç”¨html-webpack-externals-plugins æ¥é€‰æ‹©ä¸æ‰“åŒ…è¿™äº›å…¬å…±åº“,ä½†æ˜¯å¯ä»¥è®©ä»–ä»¬å»cdn é‡Œé¢åŠ è½½</p> <p>è¿˜æœ‰ä¸€ç§æ–¹å¼å°±æ˜¯åˆ©ç”¨ splitChunksPlugin</p> <h2 id="treeshaking"><a href="#treeshaking" class="header-anchor">#</a> TreeShaking</h2> <p>TressShaking æ‘‡æ ‘ä¼˜åŒ–, (commonjs ä¸æ”¯æŒ) ä»–çš„åŸç†æ˜¯DCE</p> <p>DCE æœ‰ä¸‰ç‚¹</p> <ol><li>ä»£ç ä¸å¯è¾¾</li> <li>ç»“æœä¸è¢«ç”¨åˆ°</li> <li>å˜é‡åªå†™ä¸è¯»</li></ol> <p>production æ¨¡å¼ é»˜è®¤å¼€å¯</p> <h2 id="scopehoisting"><a href="#scopehoisting" class="header-anchor">#</a> ScopeHoisting</h2> <p>åœ¨å¼€å‘ç¯å¢ƒ,é»˜è®¤webpackä¼šè¿›è¡Œå¤§é‡çš„é—­åŒ…æ¥è¿›è¡Œæ¨¡å—çš„å¯¼å…¥åŠå¯¼å‡ºæ“ä½œ,ScopeHoisting å¯ä»¥å‡å°‘ä½¿æ„å»ºå‡ºçš„å‡½æ•°ç”³æ˜ä»£ç å’Œå†…å­˜å¼€é”€</p> <p>production æ¨¡å¼é»˜è®¤å¼€å¯</p> <h2 id="æ‡’åŠ è½½jsçš„æ–¹å¼"><a href="#æ‡’åŠ è½½jsçš„æ–¹å¼" class="header-anchor">#</a> æ‡’åŠ è½½JSçš„æ–¹å¼</h2> <p>commonjs : require.ensure</p> <p>es6: åŠ¨æ€import éœ€è¦babel æ’ä»¶ æ¥æ”¯æŒè¿™æ ·çš„è¯­æ³•</p> <h2 id="æ‰“åŒ…ä¸€ä¸ªè‡ªå·±çš„ç»„ä»¶å’Œåº“"><a href="#æ‰“åŒ…ä¸€ä¸ªè‡ªå·±çš„ç»„ä»¶å’Œåº“" class="header-anchor">#</a> æ‰“åŒ…ä¸€ä¸ªè‡ªå·±çš„ç»„ä»¶å’Œåº“</h2> <p>ä¸€èˆ¬çš„ç»„ä»¶å’Œåº“æœ‰ä¸¤ä¸ªç‰ˆæœ¬,ä¸€ä¸ªæ˜¯å‹ç¼©ç‰ˆ,ä¸€ä¸ªæ˜¯éå‹ç¼©ç‰ˆ,é€šå¸¸æƒ…å†µä¸‹æ˜¯éç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨éå‹ç¼©ç‰ˆ,ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨å‹ç¼©ç‰ˆ,</p> <p>é€šè¿‡é…ç½®target: umd , æ¥æ”¯æŒ amd, cjs , esæ¨¡å—, script æ ‡ç­¾</p> <p>é€šè¿‡è®¾ç½®library ç­‰ç›¸å…³é…ç½®</p> <p>ç„¶ååˆ©ç”¨TerserPlugin æ’ä»¶æ¥è¿›è¡ŒåŒ¹é…å‹ç¼© , ä¾‹å¦‚åªå‹ç¼© .min.js ç»“å°¾çš„æ–‡ä»¶</p> <h2 id="ssr-ç©ºç¼º"><a href="#ssr-ç©ºç¼º" class="header-anchor">#</a> SSR ç©ºç¼º</h2> <h2 id="ä¼˜åŒ–æ„å»ºæ—¥å¿—"><a href="#ä¼˜åŒ–æ„å»ºæ—¥å¿—" class="header-anchor">#</a> ä¼˜åŒ–æ„å»ºæ—¥å¿—</h2> <p>é€šè¿‡statsè®¾ç½®æ¥å®Œæˆç»Ÿè®¡ä¿¡æ¯çš„è¿‡æ»¤ , ä¸€èˆ¬ä½¿ç”¨  'errors-only'  æˆ–è€…  'minimal'</p> <p>ç„¶åå€ŸåŠ©  friendly-errors-webpack-plugin  è¿™ä¸ªæ’ä»¶æ¥è¿›è¡Œå‹å¥½çš„ä¿¡æ¯æç¤º .</p> <p>ç„¶åè¿˜å¯ä»¥é€šè¿‡è‡ªå·±ç¼–å†™ ä¸€ä¸ªå°æ’ä»¶æ¥ç»‘å®šwebpackæ‰“åŒ…å®Œæˆçš„äº‹ä»¶æ¥è¿›è¡Œè‡ªå®šä¹‰æ“ä½œ</p> <h2 id="æ‰“åŒ…é€Ÿåº¦åˆ†æ"><a href="#æ‰“åŒ…é€Ÿåº¦åˆ†æ" class="header-anchor">#</a> æ‰“åŒ…é€Ÿåº¦åˆ†æ</h2> <p>åˆ©ç”¨  speed-measure-webpack-plugin  æ’ä»¶ æ¥è¿›è¡Œæ‰“åŒ…é€Ÿåº¦åˆ†æ</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// å®ä¾‹åŒ–æ’ä»¶</span>
<span class="token keyword">const</span> smp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpeedMeasurePlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> smp<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	entry <span class="token punctuation">:</span> <span class="token string">'..xxx'</span><span class="token punctuation">,</span>
    output <span class="token punctuation">:</span> <span class="token string">'xxx'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="å¤šè¿›ç¨‹å¤šå®ä¾‹æ„å»º"><a href="#å¤šè¿›ç¨‹å¤šå®ä¾‹æ„å»º" class="header-anchor">#</a> å¤šè¿›ç¨‹å¤šå®ä¾‹æ„å»º</h2> <p>åˆ©ç”¨å®˜æ–¹æ¨å‡ºçš„ thread-loader , å½“ç„¶ä¹Ÿæœ‰å…¶ä»–ç¬¬ä¸‰æ–¹çš„å¤šçº¿ç¨‹æ„å»ºæ’ä»¶,å°±æ˜¯HappyPack , webpack å®˜æ–¹æ¨èthread-loaderæ¥è¿›è¡Œå¤šå®ä¾‹æ„å»º</p> <p>æŠŠè¿™ä¸ª loader æ”¾ç½®åœ¨å…¶ä»– loader ä¹‹å‰ï¼Œ æ”¾ç½®åœ¨è¿™ä¸ª loader ä¹‹åçš„ loader å°±ä¼šåœ¨ä¸€ä¸ªå•ç‹¬çš„ worker æ± (worker pool)ä¸­è¿è¡Œ</p> <p><a href="https://www.webpackjs.com/loaders/thread-loader/" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="å¤šè¿›ç¨‹å¤šå®ä¾‹å‹ç¼©"><a href="#å¤šè¿›ç¨‹å¤šå®ä¾‹å‹ç¼©" class="header-anchor">#</a> å¤šè¿›ç¨‹å¤šå®ä¾‹å‹ç¼©</h2> <p>åˆ©ç”¨  terser-webpack-plugin    å¼€å¯ parallel å‚æ•° ï¼ˆæ¨èä½¿ç”¨è¿™ä¸ªï¼Œæ”¯æŒ ES6 è¯­æ³•å‹ç¼©ï¼‰ , å½“ç„¶è¿˜æœ‰å…¶ä»–çš„æ’ä»¶, ä¾‹å¦‚ parallel-uglify-plugin  ,  uglifyjs-webpack-plugin  ç­‰</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    minimizer<span class="token punctuation">:</span> <span class="token punctuation">[</span>
       <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
         parallel<span class="token punctuation">:</span> <span class="token number">4</span>
       <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="dll-æ‰“åŒ…"><a href="#dll-æ‰“åŒ…" class="header-anchor">#</a> DLL æ‰“åŒ…</h2> <p>dll ç±»ä¼¼äºå°†ä½ æƒ³è¦çš„æ¨¡å—æ”¾å…¥ä¸€ä¸ªå…¬å…±ä»“åº“,ç„¶åæ‰“åŒ…çš„æ—¶å€™å°±ç›´æ¥å»è¿™ä¸ªå…¬å…±ä»“åº“é‡Œé¢å–</p> <p>æƒ³è¦å®Œæˆdll æ‰“åŒ… å¾—å…ˆå®Œæˆä¸¤æ­¥</p> <ol><li>å†™ä¸€ä¸ªwebpack.dll.js æ¥ç”Ÿæˆ manifest.jsonæ–‡ä»¶å’Œä»“åº“js</li> <li>åœ¨ä½ è¦æ„å»ºçš„ä¸»æ–‡ä»¶åŠ å…¥è¿™ä¸ªdllæ’ä»¶(å’Œç”Ÿæˆdllçš„æ’ä»¶ä¸æ˜¯åŒä¸€ä¸ª)</li></ol> <p>ç¤ºä¾‹</p> <p>ç”Ÿæˆmanifest.json æ–‡ä»¶å¦‚ä¸‹</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    mode<span class="token punctuation">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
    resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        resolver<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">'vue$'</span><span class="token punctuation">:</span> <span class="token string">'vue/dist/vue.esm.js'</span> <span class="token comment">//å†…éƒ¨ä¸ºæ­£åˆ™è¡¨è¾¾å¼  vueç»“å°¾çš„</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¦ç”Ÿæˆçš„æ¨¡å—ä¸º vendor , é‡Œé¢åŒ…å« vueå’Œlodash æ¨¡å— </span>
        vendor<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">'vue'</span><span class="token punctuation">,</span>
            <span class="token string">'lodash'</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// ç”Ÿæˆçš„ ä»“åº“ js ä¸º vendor.dll.js</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        filename<span class="token punctuation">:</span> <span class="token string">'[name].dll.js'</span><span class="token punctuation">,</span>
        <span class="token comment">// å°†ä»“åº“æ–‡ä»¶å­˜æ”¾è‡³ .... </span>
        path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../dll/librarys'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// library åå­—ä¸º vendor </span>
        library<span class="token punctuation">:</span> <span class="token string">'[name]'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">'[name]'</span><span class="token punctuation">,</span>
            <span class="token comment">// ç”Ÿæˆmainifest.json æ–‡ä»¶çš„ä½ç½® </span>
            path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../dll/manifest.json'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>ç„¶ååœ¨ä¸»æ–‡ä»¶ä¸­åŠ å…¥æ­¤æ’ä»¶</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token comment">// å¼•ç”¨çš„ä¸Šä¸‹æ–‡ </span>
      		context<span class="token punctuation">:</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname <span class="token punctuation">,</span> <span class="token string">'../'</span> <span class="token punctuation">,</span> <span class="token string">'dll/'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment">// åŸºäºä¸Šä¸‹æ–‡å»æ‰¾vendor.dll.js</span>
      		name <span class="token punctuation">:</span> <span class="token string">'vendor'</span> <span class="token punctuation">,</span>
      		<span class="token comment">// å¼•å…¥js</span>
            manifest<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../dll/manifest.json'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="ç¼“å­˜æ„å»º"><a href="#ç¼“å­˜æ„å»º" class="header-anchor">#</a> ç¼“å­˜æ„å»º</h2> <p>ç¼“å­˜æ„å»ºå°±æ˜¯å°†ç¬¬ä¸€æ¬¡æ„å»ºçš„ä¸€äº›ä¸œè¥¿ç¼“å­˜èµ·æ¥ , ç¼“å­˜ç›®å½•ä¸º node_modules ä¸­çš„ .cache æ–‡ä»¶å¤¹ä¸­</p> <p>ç¼“å­˜æ„å»ºåˆ†ä¸ºä¸‰ç§æ„å»º</p> <ol><li>babel è½¬æ¢ç¼“å­˜</li> <li>terser-webpack-plugin  å‹ç¼©ç¼“å­˜</li> <li>hard-source-webpack-plugin  ä¸šåŠ¡æ¨¡å—ç¼“å­˜</li></ol> <p>ä¸€ä¸ªä¸€ä¸ªæ¥:</p> <p>babelç¼“å­˜</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
   loader<span class="token punctuation">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
   options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
         presets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         cacheDirectory<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment">// å¼€å¯ç¼“å­˜</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>terser ç¼“å­˜</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code> optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        minimizer<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                parallel<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                cache<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment">// å¼€å¯ç¼“å­˜</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ä¸šåŠ¡ç¼“å­˜</p> <p>åŠ å…¥è¿™ä¸ªæ’ä»¶å³å¯</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code> plugins<span class="token punctuation">:</span><span class="token punctuation">[</span>
 	<span class="token keyword">new</span> <span class="token class-name">HardSourceWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    
 <span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="å›¾ç‰‡å‹ç¼©"><a href="#å›¾ç‰‡å‹ç¼©" class="header-anchor">#</a> å›¾ç‰‡å‹ç¼©</h2> <p>è™½ç„¶æœ‰url-loader æ¥å®ŒæˆæŒ‡å®šå¤§å°å†…å›¾ç‰‡å°†è½¬ä¸ºbase64.ä½†æ˜¯åœ¨å¤§å›¾ç‰‡çš„æƒ…å†µä¸‹ æˆ‘ä»¬è¿˜æ˜¯å¸Œæœ›èƒ½è‡ªåŠ¨åŒ–çš„å®Œæˆå›¾ç‰‡å‹ç¼©
åœ¨æ•™ç¨‹ä¸Šé¢çœ‹çš„ä½¿ç”¨ imagemin-webpack-plugin è¿™ä¸ªæ’ä»¶æ¥å®Œæˆè¿™ä¸ªè‡ªåŠ¨åŒ–åŠŸèƒ½, ä½†æ˜¯æœ¬äººè¯•çš„æ—¶å€™ä¸ä»…æ²¡æ•ˆæœè¿˜è´¼æ…¢,ä¼°è®¡æ˜¯ç¢°åˆ°å‘äº† , æ‰€ä»¥è½¬å¿µæ¢äº†å¦å¤–ä¸€ä¸ªæ–¹å¼
.ä½¿ç”¨ image-webpack-loader</p> <p>ä¸‹é¢ç›´æ¥çœ‹ä»£ç </p> <p>é¦–å…ˆå®‰è£…image-webpack-loader</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i -D image-webpack-loader
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è½½å…¥é…ç½®</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>        <span class="token punctuation">{</span>
                test<span class="token punctuation">:</span> <span class="token regex">/\.(png|svg|jpeg|jpg)$/i</span><span class="token punctuation">,</span>
                use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span>
                        loader<span class="token punctuation">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
                        options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                            limit<span class="token punctuation">:</span> <span class="token number">50000</span><span class="token punctuation">,</span>
                            name<span class="token punctuation">:</span> <span class="token string">'images/[name]_[hash].[ext]'</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>
                        loader<span class="token punctuation">:</span> <span class="token string">&quot;image-webpack-loader&quot;</span> <span class="token punctuation">,</span>
                        options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                            bypassOnDebug <span class="token punctuation">:</span><span class="token boolean">true</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>æ­¤æ—¶  image-webpack-loader å°±ä¼šè‡ªåŠ¨å°†å›¾ç‰‡è¿›è¡Œå‹ç¼©,å¹¶ä¸”å¥½åƒä¼šå­˜æ”¾è‡³image ç›®å½•ä¸­</p> <p>End</p> <h2 id="csstreeshaking"><a href="#csstreeshaking" class="header-anchor">#</a> CSSTreeShaking</h2> <p>æŠ¹é™¤æ²¡æœ‰ç”¨åˆ°çš„css</p> <p>æ—¥å¸¸ç¬¬ä¸€æ­¥ å®‰è£…</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>    <span class="token function">npm</span> i -D glob-all purify-css purifycss-webpack 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ç„¶åå°±å¼€å§‹é…ç½® æ·»åŠ è¿™ä¸ªæ’ä»¶</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code> <span class="token keyword">new</span> <span class="token class-name">PurifyCSS</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// è¯»å– srcä¸‹é¢çš„ æ‰€æœ‰çš„html å’Œ æ‰€æœ‰çš„js , æ¥æ‰«ææ˜¯å¦ä½¿ç”¨åˆ°äº†è¿™ä¸ªcss é€‰æ‹©å™¨ </span>
    paths<span class="token punctuation">:</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
             path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname <span class="token punctuation">,</span> <span class="token string">'../'</span> <span class="token punctuation">,</span> <span class="token string">'src/*/*.html'</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
             path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname <span class="token punctuation">,</span> <span class="token string">'../'</span> <span class="token punctuation">,</span> <span class="token string">'src/*/*.js'</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>ç¨å¾®æ³¨æ„ä¸€ä¸‹çš„æ˜¯, å¦‚æœé…ç½®é”™è¯¯,ä½ æ‰“åŒ…å‡ºæ¥çš„css å°†ä¼šæ²¡æœ‰å†…å®¹
End</p> <h2 id="åŠ¨æ€polyfill"><a href="#åŠ¨æ€polyfill" class="header-anchor">#</a> åŠ¨æ€polyfill</h2> <p>è®©babel-core è§£å†³ es6ç®­å¤´å‡½æ•° ç­‰ç­‰è¯­æ³•é—®é¢˜ , ç„¶åä½¿ç”¨åŠ¨æ€polyfill æ¥æ ¹æ®æµè§ˆå™¨çš„User-Agent æ¥è¿›è¡Œè‡ªåŠ¨è·å–polyfill</p> <p>å…¶å®å°±æ˜¯ä¸€æ®µscript æ ‡ç­¾, ç„¶åæˆ‘ä»¬ä½¿ç”¨ é˜¿é‡Œ æä¾›çš„</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://polyfill.alicdn.com/polyfill.min.js?features=Promise%2CArray.prototype.includes<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä»–ä»¬é‡‡ç”¨features æ¥æ§åˆ¶ä½ éœ€è¦çš„polifll å…¼å®¹, å¦‚æœä¸ä¼ é»˜è®¤ å°±é»˜è®¤å…¨å±€polyfll</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">singee write to :</span> <span class="time">12/16/2019, 10:25:35 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c7624f26.js" defer></script><script src="/assets/js/2.04cf5e0d.js" defer></script><script src="/assets/js/23.bc303b71.js" defer></script>
  </body>
</html>
